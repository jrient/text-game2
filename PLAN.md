# 像素割草游戏 - PixelSurvivor 开发计划

## 一、游戏概述

**游戏名称：** PixelSurvivor（像素幸存者）
**游戏类型：** 像素风自动战斗 Roguelite 割草游戏
**平台：** 浏览器（移动端优先，PC 兼容）
**参考游戏：** Vampire Survivors、Brotato、Survivor.io

### 核心体验
- 玩家操控角色在像素世界中自动攻击，手动移动躲避敌人
- 击杀敌人掉落经验宝石，收集升级
- 升级时从三张技能卡中选择一张，构建专属流派
- 关卡模式挑战 Boss，无尽模式刷新最高波数记录

---

## 二、核心机制设计

### 2.1 玩家系统
- **移动**：虚拟摇杆（移动端）/ WASD 或方向键（PC）
- **自动攻击**：无需手动，武器自动攻击最近/最多敌人
- **属性**：HP（生命）、速度（移速）、攻击力、冷却时间、拾取范围

### 2.2 经验与升级
- 击杀敌人掉落经验宝石（绿色小球）
- 进入拾取范围自动吸附
- 经验槽满后弹出升级选择界面（游戏暂停）
- 每升一级提供 **3 张随机技能卡** 供选择

### 2.3 技能系统

#### 武器（主动技能）—— 自动触发
| 技能名 | 效果 | 进化条件 |
|--------|------|---------|
| 魔法弹 | 向最近敌人射击 | + 攻击强化 → 追踪弹 |
| 旋转斧 | 绕玩家旋转 | + 冷却强化 → 风暴斧 |
| 飞刀 | 向移动方向飞出 | + 速度强化 → 刀雨 |
| 火球 | 爆炸AOE伤害 | + 护甲强化 → 业火 |
| 闪电链 | 链式跳跃伤害 | + 拾取强化 → 雷暴 |
| 大蒜气息 | 近身持续伤害光环 | + 生命强化 → 圣光 |

#### 被动强化（升级武器）
| 技能名 | 效果 |
|--------|------|
| 攻击强化 | 伤害 +20% |
| 速度强化 | 移速 +15% |
| 护甲强化 | 受伤 -15% |
| 生命强化 | 最大HP +30 |
| 冷却强化 | 冷却 -15% |
| 拾取强化 | 拾取范围 +50% |
| 吸血 | 击杀回复少量HP |

#### 技能进化（武器 + 被动满级 = 进化武器）
- 集齐武器 Lv.5 + 对应被动 → 触发进化，威力大幅提升

### 2.4 关卡模式（5关）
| 关卡 | 场景 | 时长 | 特色敌人 | Boss |
|------|------|------|---------|------|
| 1 | 像素森林 | 3分钟 | 史莱姆、蘑菇怪 | 树精Boss |
| 2 | 沙漠遗迹 | 4分钟 | 沙漠虫、骷髅 | 沙漠蝎王 |
| 3 | 幽灵城堡 | 4分钟 | 幽灵、骑士 | 黑暗骑士 |
| 4 | 熔岩洞窟 | 5分钟 | 火焰魔、岩石怪 | 熔岩巨人 |
| 5 | 虚空领域 | 5分钟 | 虚空触手、混沌体 | 最终Boss |

### 2.5 无尽模式
- 无时间限制，波数无限增加
- 每10波出现精英怪，每20波出现Boss
- 记录最高存活波数

---

## 三、技术架构

### 技术栈
- **游戏引擎：** Phaser 3（CDN 加载，无需构建工具）
- **渲染：** WebGL（自动降级 Canvas）
- **像素字体：** Press Start 2P（Google Fonts）
- **虚拟摇杆：** nipplejs 库
- **部署：** Nginx + Docker Compose

### 目录结构
```
text-game2/
├── docker-compose.yml          # Docker 编排文件
├── nginx.conf                  # Nginx 配置
├── PLAN.md                     # 本计划文档
├── README.md                   # 项目说明
└── game/
    ├── index.html              # 入口 HTML
    ├── assets/
    │   ├── sprites/            # 像素精灵图（程序生成）
    │   └── audio/              # 音效（Web Audio API 生成）
    └── src/
        ├── main.js             # 游戏入口，场景注册
        ├── config.js           # 全局配置（分辨率、颜色等）
        ├── scenes/
        │   ├── BootScene.js    # 启动场景（加载资源）
        │   ├── MenuScene.js    # 主菜单（选模式）
        │   ├── GameScene.js    # 核心游戏场景
        │   ├── LevelUpScene.js # 升级选卡界面
        │   ├── PauseScene.js   # 暂停界面
        │   └── GameOverScene.js # 结算界面
        ├── entities/
        │   ├── Player.js       # 玩家角色
        │   ├── Enemy.js        # 基础敌人
        │   ├── Boss.js         # Boss 敌人
        │   └── ExpOrb.js       # 经验宝石
        ├── weapons/
        │   ├── BaseWeapon.js   # 武器基类
        │   ├── MagicBolt.js    # 魔法弹
        │   ├── RotatingAxe.js  # 旋转斧
        │   ├── ThrowingKnife.js# 飞刀
        │   ├── Fireball.js     # 火球
        │   ├── Lightning.js    # 闪电链
        │   └── GarlicAura.js   # 大蒜光环
        ├── systems/
        │   ├── SkillSystem.js  # 技能管理（获取/升级/进化）
        │   ├── WaveSystem.js   # 波次生成系统
        │   ├── PoolSystem.js   # 对象池（性能优化）
        │   └── AudioSystem.js  # 音效系统
        └── data/
            ├── skills.js       # 技能配置数据
            ├── enemies.js      # 敌人配置数据
            └── levels.js       # 关卡配置数据
```

---

## 四、UI 设计（移动端优先）

### 游戏内 HUD
```
┌─────────────────────────────────┐
│ ❤️ ████████░░  Lv.5  ⏱ 02:30  │  ← 顶部状态栏
│ ✨ ████░░░░░░                   │  ← 经验条
├─────────────────────────────────┤
│                                 │
│          游戏区域               │
│       （像素世界地图）          │
│                                 │
├─────────────────────────────────┤
│  ◉          [暂停] [技能x3]    │  ← 底部控制栏
│ 摇杆                            │
└─────────────────────────────────┘
```

### 升级选卡界面
```
┌─────────────────────────────────┐
│        ✨ 升级啦！              │
│                                 │
│  ┌───────┐ ┌───────┐ ┌───────┐ │
│  │ 🔥    │ │ ⚡    │ │ 💚    │ │
│  │火球术 │ │闪电链 │ │生命强化│ │
│  │AOE爆炸│ │跳跃伤害│ │+30HP  │ │
│  │Lv.1  │ │NEW   │ │Lv.2  │ │
│  └───────┘ └───────┘ └───────┘ │
└─────────────────────────────────┘
```

---

## 五、开发阶段计划

### Phase 1：基础框架搭建（Day 1）
- [x] 项目结构初始化
- [ ] Phaser 3 集成，游戏分辨率配置（390x844，移动端比例）
- [ ] 主菜单场景（关卡/无尽模式入口）
- [ ] 玩家角色渲染 + 虚拟摇杆移动
- [ ] 像素地图（平铺背景）
- **提交：** `feat: Phase 1 - 基础框架与玩家移动`

### Phase 2：核心战斗系统（Day 2）
- [ ] 敌人生成系统（从屏幕外刷新）
- [ ] 敌人 AI（追踪玩家）
- [ ] 碰撞检测（敌人伤害玩家）
- [ ] 首个武器：魔法弹（自动攻击）
- [ ] 经验宝石掉落与吸附收集
- [ ] 经验条 + 升级触发
- **提交：** `feat: Phase 2 - 战斗系统与经验升级`

### Phase 3：技能系统（Day 3）
- [ ] 升级选卡界面（3张随机卡）
- [ ] 所有 6 种武器实现
- [ ] 所有 7 种被动技能
- [ ] 技能进化逻辑
- [ ] 对象池优化（子弹/敌人复用）
- **提交：** `feat: Phase 3 - 完整技能系统`

### Phase 4：游戏模式（Day 4）
- [ ] 关卡模式：5 个关卡配置 + Boss 战
- [ ] 无尽模式：动态波次强度递增
- [ ] 游戏结算界面（通关/死亡）
- [ ] 暂停功能
- [ ] HP 系统（受伤、死亡）
- **提交：** `feat: Phase 4 - 关卡与无尽模式`

### Phase 5：美化与手感打磨（Day 5）
- [ ] 像素风视觉效果（粒子、闪光、击退）
- [ ] 屏幕震动反馈
- [ ] Web Audio API 音效（攻击音、升级音、死亡音）
- [ ] 像素字体应用
- [ ] 移动端适配优化（防止滚动、全屏）
- **提交：** `feat: Phase 5 - 视觉音效打磨`

### Phase 6：部署（Day 6）
- [ ] Docker Compose 配置（Nginx 静态服务）
- [ ] Nginx 配置（gzip、缓存、移动端）
- [ ] README 更新
- **提交：** `feat: Phase 6 - Docker 部署配置`
- **推送：** `git push origin main`

---

## 六、像素艺术方案

由于不依赖外部美术资源，所有图形使用 **程序化像素绘制**：
- Phaser Graphics API 绘制像素方块角色
- 调色板：限定 16 色像素风配色
- 动画：通过程序逐帧切换颜色/位置实现
- 效果：粒子系统模拟像素爆炸效果

---

## 七、性能目标

- 移动端稳定 60fps（目标设备：中端安卓/iOS）
- 同屏最多 200 个敌人（对象池控制）
- 首屏加载 < 3秒（CDN 资源）
- 游戏包体 < 500KB（无外部图片资源）

---

## 八、Docker 部署方案

```yaml
# docker-compose.yml
services:
  game:
    image: nginx:alpine
    ports:
      - "8080:80"
    volumes:
      - ./game:/usr/share/nginx/html
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
```

访问地址：`http://localhost:8080`
移动端访问：`http://<服务器IP>:8080`

---

## 九、自测清单

每个阶段完成后执行：

**功能测试：**
- [ ] PC 端 Chrome/Firefox 正常运行
- [ ] 移动端 Safari/Chrome 正常运行
- [ ] 虚拟摇杆响应流畅
- [ ] 升级选卡界面正常弹出
- [ ] 技能效果正确触发
- [ ] 关卡模式可通关
- [ ] 无尽模式持续运行无崩溃

**性能测试：**
- [ ] 100+ 敌人同屏不掉帧
- [ ] 内存无持续增长（无内存泄漏）

---

*计划版本：v1.0 | 日期：2026-02-26*
